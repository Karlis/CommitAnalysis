# # Comment the other projets.

# # # Spring
# size = c( 1068, 10, 21, 26, 94, 20, 94, 938, 69, 5, 1719, 70, 59, 48, 2531, 5825, 56, 34, 404, 7, 18, 89, 101, 3, 52, 2, 1, 157, 63, 43, 1, 124, 86, 421, 209, 148, 5, 17, 2, 128, 89, 27, 5, 3, 13, 89, 72, 5, 316, 3374, 97, 111, 7, 407, 62, 123, 16, 1, 40, 21, 12, 2, 2, 9, 1, 16, 1, 121, 15, 9, 201, 4, 3, 2, 42, 25, 37, 392, 9, 17, 196, 349, 8, 27, 34, 33, 8, 745, 23, 77, 46, 109, 101, 23, 12, 545, 165, 15, 56, 237, 19, 383, 20, 11, 39, 147, 2, 7, 2, 52, 134, 2, 129, 35, 100, 74, 131, 8, 52, 15 )
# added = c( 874, 8, 21, 18, 83, 20, 48, 938, 43, 5, 867, 57, 59, 39, 12, 5825, 56, 34, 321, 5, 18, 32, 88, 3, 41, 2, 1, 52, 49, 23, 1, 73, 73, 376, 187, 131, 0, 5, 2, 75, 65, 27, 3, 3, 10, 16, 72, 5, 20, 1313, 82, 46, 6, 253, 35, 119, 15, 0, 36, 17, 12, 2, 2, 7, 0, 9, 1, 45, 12, 9, 91, 3, 3, 2, 38, 25, 34, 246, 9, 15, 178, 289, 8, 18, 34, 33, 4, 745, 10, 49, 37, 69, 92, 20, 11, 291, 109, 15, 53, 221, 19, 379, 19, 11, 34, 147, 2, 6, 2, 49, 122, 0, 22, 35, 58, 74, 130, 7, 37, 4 )
# removed =c( 351, 6, 1, 12, 21, 0, 48, 0, 49, 1, 852, 23, 3, 21, 2527, 2, 33, 7, 92, 4, 18, 67, 25, 0, 15, 2, 1, 147, 26, 27, 1, 110, 65, 112, 117, 43, 5, 14, 2, 116, 81, 5, 3, 1, 5, 84, 0, 5, 305, 2088, 55, 78, 1, 182, 33, 9, 4, 1, 21, 18, 12, 2, 2, 3, 1, 8, 1, 101, 8, 7, 120, 1, 1, 2, 9, 21, 12, 174, 6, 15, 19, 62, 2, 26, 28, 27, 4, 6, 20, 29, 21, 63, 16, 17, 7, 264, 83, 2, 15, 21, 4, 13, 3, 11, 12, 2, 1, 6, 2, 3, 21, 2, 114, 3, 59, 74, 3, 4, 20, 11 )

# # # Gedit
# size = c( 88, 1, 2522, 113, 7, 291, 26, 89, 61, 90, 10, 8, 1, 2, 499, 124, 6066, 20, 46, 5, 355, 6, 122, 226, 22, 20, 136, 1, 2, 2, 578, 45, 960, 222, 352, 1066, 1, 141, 117, 525, 10, 21, 1, 48, 744, 1064, 24, 25, 137, 1724, 2659, 448, 2, 1, 1, 101, 30, 2, 28, 2,117, 197, 14, 72, 21, 1, 40, 17, 40, 4, 85, 50, 13, 4, 1, 1588, 1915, 1, 37, 24, 57, 57, 69, 7, 88, 6, 19, 32, 12, 6, 204, 515, 2, 7, 21, 153, 106, 101, 2, 3526, 234, 55, 4, 6, 41, 2, 342, 3, 11, 1, 423, 59, 37, 15, 48, 799, 161, 119, 5, 187 )
# added = c( 54, 1, 449, 9, 0, 262, 25, 64, 23, 0, 10, 2, 0, 0, 483, 124, 4158, 20, 44, 5, 285, 0, 2, 212, 14, 18, 134, 1, 2, 2, 528, 45, 480, 144, 328, 725, 1, 121, 46, 511, 10, 11, 1, 39, 570, 992, 24, 25, 133, 1045, 1373, 393, 0, 1, 1, 93, 30, 2, 20, 2, 117, 197, 14, 13, 19, 0, 40, 17, 40, 4, 47, 18, 6, 4, 1, 1038, 1034, 1, 37, 22, 50, 38, 43, 7, 55, 2, 12, 0, 10, 6, 185, 355, 2, 0, 17, 147, 86, 22, 2, 3526, 138, 52, 1, 6, 41, 2, 40, 3, 11, 1, 384, 32, 34, 2, 41, 620, 74, 102, 4, 64 )
# removed = c( 36, 0, 2502, 107, 7, 202, 26, 63, 48, 90, 2, 8, 1, 2, 200, 88, 1949, 19, 31, 0, 282, 6, 120, 100, 9, 13, 91, 1, 0, 2, 472, 36, 558, 174, 299, 653, 1, 23, 73, 14, 0, 16, 1, 12, 538, 609, 4, 1, 80, 1036, 1413, 381, 2, 1, 1, 26, 5, 1, 18, 0, 55, 164, 14, 59, 18, 1, 32, 0, 1, 4, 44, 46, 11, 4, 1, 1033, 925, 1, 1, 7, 25, 22, 44, 0, 39, 6, 9, 32, 2, 3, 180, 340, 2, 7, 7, 149, 81, 80, 1, 0, 127, 10, 3, 0, 1, 1, 315, 0, 0, 0, 307, 28, 3, 13, 39, 580, 101, 15, 1, 143 )

# # # Eclpise
# size = c( 55, 4, 24, 57, 102, 213, 222, 323, 142, 8, 12, 67, 1, 25, 38, 1, 1, 3, 107, 38, 303, 13, 611, 86, 41, 1, 1, 42, 5, 14, 97, 122, 3, 2, 3, 61, 15, 185, 94, 3, 38, 41, 16, 5, 4, 431, 12, 11, 352, 114, 11, 3, 1, 3, 31, 3, 2, 8, 561, 10, 4, 179, 2, 129, 611, 3, 184, 16, 62, 36, 16, 38, 1, 386, 35, 29, 109, 19, 6, 26, 30, 1048, 41, 48, 14, 13, 92, 4, 1, 431, 41, 71, 116, 123, 1, 1, 62, 190, 77, 319, 353, 44, 362, 16, 46, 31, 67, 14, 3, 62, 128, 1, 1, 8, 145, 11, 1, 4, 34, 141 )
# added = c( 55, 4, 24, 56, 102, 213, 198, 315, 104, 8, 11, 67, 1, 24, 18, 1, 1, 3, 107, 22, 285, 13, 608, 40, 41, 1, 1, 39, 5, 14, 93, 114, 2, 2, 3, 61, 14, 182, 94, 2, 37, 41, 16, 5, 2, 420, 12, 9, 351, 109, 9, 3, 1, 3, 31, 3, 2, 8, 536, 0, 4, 172, 2, 129, 608, 2, 182, 16, 61, 36, 15, 22, 1, 161, 35, 15, 98, 17, 6, 26, 30, 42, 19, 43, 14, 13, 29, 4, 1, 420, 37, 33, 114, 114, 1, 1, 41, 185, 62, 243, 351, 43, 362, 16, 45, 31, 67, 3, 3, 59, 62, 1, 1, 8, 79, 9, 1, 4, 34, 104 )
# removed = c( 55, 4, 1, 4, 1, 8, 37, 66, 93, 5, 4, 2, 0, 1, 35, 1, 0, 1, 13, 17, 28, 0, 278, 49, 6, 1, 1, 22, 0, 0, 19, 11, 3, 2, 1, 2, 2, 13, 2, 3, 8, 8, 3, 5, 4, 18, 12, 5, 18, 7, 11, 0, 0, 0, 29, 2, 1, 0, 41, 10, 3, 179, 0, 1, 278, 3, 13, 0, 2, 1, 14, 17, 0, 180, 0, 14, 19, 2, 6, 1, 1, 1009, 28, 7, 0, 0, 73, 4, 0, 18, 40, 46, 3, 11, 1, 0, 24, 7, 17, 215, 18, 3, 1, 3, 1, 29, 2, 12, 1, 5, 69, 1, 0, 0, 70, 11, 0, 4, 34, 93 )

# # JUnit
# size = c( 3, 48, 1, 8, 7, 41, 1, 13, 16, 1, 14, 8, 6, 59, 197, 8, 10, 66, 1, 37, 29, 31, 1, 26, 2, 2, 12, 2, 1, 1, 73, 1, 20, 15, 2352, 3, 3, 3, 2, 29, 77, 394, 586, 1, 1, 36, 2, 2, 2, 305, 24, 88, 1, 406, 2, 70, 3, 2, 2, 1, 30, 627, 19, 85, 2, 28, 10, 2, 1, 27, 5, 22, 2, 25, 386, 55, 1, 8, 1, 2, 357, 288, 1, 43, 33, 6, 3, 15, 2, 4, 49, 5, 144, 6, 55, 28, 13, 4, 6, 20, 154, 165, 13, 173, 26, 97, 280, 1, 7, 32, 8, 14, 55, 30, 78, 3, 1, 2, 1, 120 )
# added = c( 3, 48, 1, 8, 7, 19, 1, 12, 16, 1, 14, 6, 4, 33, 137, 2, 10, 36, 1, 34, 17, 21, 1, 20, 1, 2, 12, 2, 1, 1, 73, 1, 9, 13, 2352, 2, 3, 2, 2, 1, 73, 11, 301, 1, 1, 23, 2, 2, 2, 151, 9, 42, 0, 277, 2, 56, 3, 2, 0, 1, 30, 354, 9, 61, 2, 21, 10, 2, 1, 27, 5, 18, 0, 17, 167, 1, 0, 6, 1, 2, 204, 122, 1, 43, 19, 5, 0, 13, 2, 2, 47, 5, 125, 1, 19, 23, 11, 2, 6, 20, 46, 138, 13, 45, 26, 53, 194, 1, 7, 31, 1, 14, 38, 30, 64, 3, 1, 2, 1, 120 )
# removed =  c( 3, 0, 0, 2, 3, 35, 1, 1, 1, 1, 0, 2, 6, 35, 87, 8, 4, 34, 1, 33, 13, 20, 1, 11, 2, 2, 0, 2, 1, 1, 49, 1, 13, 13, 3, 1, 3, 3, 2, 29, 9, 384, 289, 1, 1, 19, 0, 1, 2, 154, 24, 47, 1, 145, 0, 67, 3, 2, 2, 1, 0, 285, 13, 38, 2, 8, 0, 2, 1, 0, 0, 16, 2, 11, 219, 55, 1, 7, 1, 2, 195, 203, 0, 0, 23, 4, 3, 13, 2, 4, 10, 1, 24, 6, 49, 27, 2, 4, 0, 0, 115, 33, 0, 130, 0, 53, 191, 1, 7, 1, 8, 12, 35, 30, 14, 3, 0, 2, 1, 73 )

# # Elasticsearch
# size = c( 26, 29, 42, 1, 1934, 13, 21, 203, 1, 6, 164, 72, 78, 25, 62, 1, 11, 72, 272, 8, 25, 77, 1, 2, 8, 21, 47, 23, 7, 1229, 321, 10, 135, 36, 19, 66, 4, 127, 24, 60, 6, 661, 100, 19, 2607, 46, 46, 46, 1117, 1, 9, 625, 28, 124, 8, 22, 5, 40, 5, 1, 1, 531, 6, 112, 80, 805, 123, 145, 7, 118, 19, 6, 9, 18, 400, 292, 23, 57, 156, 90, 1, 253, 17, 33, 128, 49, 1, 5, 27, 138, 2, 105, 8, 13, 1476, 51, 141, 172, 2, 2, 64, 16, 7, 41, 3, 9, 5, 57, 342, 8, 11, 672, 61, 1, 209, 1, 113, 232, 48, 1 )
# added = c( 24, 27, 41, 1, 187, 13, 17, 109, 1, 4, 0, 69, 0, 25, 57, 1, 10, 10, 270, 8, 25, 79, 1, 2, 8, 0, 26, 12, 7, 1018, 296, 10, 135, 31, 15, 63, 4, 126, 24, 38, 6, 87, 24, 10, 2189, 29, 39, 45, 90, 0, 9, 423, 15, 79, 0, 22, 3, 16, 5, 1, 1, 480, 6, 6, 46, 804, 120, 144, 5, 117, 19, 6, 9, 18, 398, 290, 10, 57, 108, 14, 1, 251, 17, 29, 128, 49, 1, 5, 27, 111, 2, 52, 8, 11, 1469, 41, 135, 131, 2, 2, 58, 16, 7, 26, 3, 9, 0, 55, 341, 8, 4, 643, 61, 1, 209, 1, 108, 69, 33, 1 )
# removed = c( 2, 5, 2, 1, 1847, 3, 20, 100, 1, 3, 164, 8, 78, 0, 5, 1, 1, 75, 10, 1, 5, 9, 1, 2, 8, 21, 47, 13, 7, 360, 61, 10, 0, 7, 4, 16, 4, 25, 11, 36, 4, 628, 100, 14, 833, 23, 10, 3, 1071, 1, 0, 375, 17, 35, 8, 7, 2, 26, 0, 1, 1, 107, 0, 107, 78, 2, 16, 6, 3, 17, 6, 6, 0, 6, 64, 70, 13, 0, 52, 99, 1, 30, 16, 11, 6, 21, 1, 5, 0, 32, 0, 62, 0, 2, 15, 12, 23, 172, 2, 2, 45, 3, 1, 39, 3, 1, 5, 3, 8, 1, 11, 35, 1, 1, 7, 1, 11, 114, 16, 1 )

# # Storm
# size = c( 9, 1, 12, 2, 7, 2, 54, 87, 95, 94, 2809, 10, 6, 1, 2, 6, 11, 4, 1, 11, 81, 1, 2, 9, 194, 25, 11, 3, 126, 12, 28, 4, 67, 2, 185, 159, 2, 8, 147, 8, 11, 1, 66, 8, 8, 2, 2, 1, 1, 32, 1, 20, 5, 1, 27, 6, 1, 1, 1, 595, 11, 1, 42, 12, 313, 2, 1, 6, 7, 13, 18, 3, 13, 27, 3, 8, 45, 22, 1, 4, 1204, 1, 13, 1, 45, 1, 5, 63, 4, 8, 25, 3, 28, 120, 7, 310, 23, 15, 6, 13, 11, 400, 93, 61, 6, 9725, 75, 20, 2, 96, 1, 1, 4, 29, 1, 1, 1417, 3, 25, 1 )
# added = c( 9, 1, 12, 0, 7, 2, 54, 86, 95, 93, 2574, 0, 4, 1, 2, 5, 0, 4, 1, 9, 41, 1, 2, 9, 187, 21, 0, 3, 17, 3, 4, 4, 42, 2, 70, 85, 1, 8, 91, 2, 11, 1, 62, 8, 8, 1, 2, 1, 1, 29, 1, 19, 5, 1, 18, 1, 1, 1, 1, 595, 11, 1, 42, 6, 213, 2, 1, 6, 7, 8, 18, 3, 12, 25, 3, 8, 22, 19, 1, 4, 729, 1, 13, 1, 45, 1, 5, 63, 2, 8, 25, 3, 24, 86, 7, 306, 23, 15, 4, 3, 11, 400, 92, 61, 6, 9725, 75, 20, 2, 31, 1, 1, 4, 29, 0, 0, 1413, 3, 23, 1 )
# removed = c( 2, 0, 2, 2,  6, 2, 1,   6, 95, 87, 2673, 10, 5, 0, 0, 4, 11, 1, 1, 11, 54, 0, 0, 0, 14, 6, 11, 3, 116, 10, 25, 1, 37, 2, 115, 77, 2, 4, 90, 8, 3, 1, 4, 6, 6, 2, 2, 1, 1, 3, 1, 4, 2, 1, 17, 6, 1, 1, 0, 0, 2, 0, 2, 12, 160, 2, 1, 5, 7, 8, 17, 1, 1, 4, 0, 3, 29, 7, 1, 4, 480, 1, 0, 1, 3, 1, 2, 2, 4, 6, 7, 3, 18, 55, 7, 17, 0, 2, 5, 11, 0, 2, 1, 61, 6, 421, 1, 0, 2, 66, 1, 1, 1, 9, 1, 1, 5, 0, 3, 1 )



# Data frame
sx <- data.frame( Added=added, Removed=removed, Size=size)

# Variables
ratios = c(1/2, 1/3, 1/4, 1/5)
repeat_times = 100

# For each ratio we do 100 times
result_matrix = NULL

times = 1:length(ratios)

# for each ratio
for (k in 1:length(ratios) ) {
  sample_ratio = ratios[k]
  sample_size = nrow(sx) * sample_ratio

  mean_squared_errors = NULL
  # Get a sample of 100 mse's
  for (i in 1:repeat_times ) {

    #Random selection of samples
    permuation = sample(nrow(sx))
    training_sample = sx[permuation[(sample_size+1):120],]
    test_sample = sx[permuation[1:sample_size],]

    model = lm( Size ~ Added + Removed, data = training_sample)
    predicted = predict(model, test_sample)
    residuals = (test_sample$Size - predicted)

    mse = sum( residuals^2 ) / (length(residuals)-1)
    mean_squared_errors = c(mean_squared_errors, mse)
  }
  result_matrix = cbind(result_matrix, mean_squared_errors)
  colnames(result_matrix)[k] = round(sample_ratio,2)
}

boxplot(result_matrix,outline=FALSE, main="Mean Squared Errors by case split")

